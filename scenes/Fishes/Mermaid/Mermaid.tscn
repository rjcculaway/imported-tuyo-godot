[gd_scene load_steps=15 format=3 uid="uid://deifdrtbep5qh"]

[ext_resource type="Script" path="res://scenes/Fishes/Mermaid/Mermaid.gd" id="1_qhv04"]
[ext_resource type="Script" path="res://scenes/Fishes/Mermaid/MermaidPathFollow.gd" id="2_ef8c6"]
[ext_resource type="Shader" path="res://scenes/Fishes/Mermaid/Mermaid.gdshader" id="3_5je2g"]
[ext_resource type="Texture2D" uid="uid://br28clahhb0mx" path="res://assets/graphics/mermaid.png" id="4_03ghs"]
[ext_resource type="Theme" uid="uid://beone4616rq8g" path="res://assets/themes/theme.tres" id="5_kglyx"]
[ext_resource type="Script" path="res://scenes/Fishes/Mermaid/MermaidProgress.gd" id="6_w1srh"]

[sub_resource type="Curve2D" id="Curve2D_13ppp"]
_data = {
"points": PackedVector2Array(200, 0, 0, 0, 0, 0, 0, 100, 0, -100, -100, -100, 0, 0, 0, 0, 0, -200, 0, -100, 0, 100, 100, -100, 0, 0, 0, 0, 0, 0, 0, -100, 0, 100, -100, 100, 0, 0, 0, 0, 0, 200, 0, 100, 0, -100, 100, 100, 0, 0, 0, 0, 0, 0)
}
point_count = 9

[sub_resource type="ShaderMaterial" id="ShaderMaterial_3mcd6"]
shader = ExtResource("3_5je2g")
shader_parameter/flash_progress = 0.0

[sub_resource type="OccluderPolygon2D" id="OccluderPolygon2D_q5ffp"]
polygon = PackedVector2Array(63, -143, 64.5, -137, 70.8, -137, 74, -133.8, 74, -128, 79.8, -128, 83, -124.8, 83, -119, 88.8, -119, 92, -115.8, 92, -91.6, 101, -89.6, 101, -83, 124.8, -83, 128, -79.8, 128, -55.6, 137, -53.6, 137, -38, 142.8, -38, 144, -36.8, 144, 0, 143.3, 0, 126, 2.3, 126, -1, 124.5, -7, 101, -7, 101, 8.60001, 92, 10.6, 92, 16.8, 88.8, 20, 74, 20, 74, 25, 81, 25, 81, 28, 82.5, 34, 88.8, 34, 92, 37.2, 92, 90, 89.1, 90, 83, 91.5, 83, 97.8, 79.8, 101, 74, 101, 74, 106.8, 70.8, 110, 0.399994, 110, -1.60001, 101, -7.8, 101, -11, 97.8, -11, 92, -25, 92, -25, 97.4, -16, 99.4, -16, 124.4, -7, 126.4, -7, 142.8, -8.2, 144, -27, 144, -28.6, 137, -63, 137, -63, 134, -64.5, 128, -124.4, 128, -126.4, 137, -144, 137, -144, 134, -144, 117, -143.1, 117, -137, 115.5, -137, 99, -134.1, 99, -128, 97.5, -128, 81, -125.2, 81, -110, 79.2, -110, 72.4, -101, 70.4, -101, 55.2, -97.8, 52, -82.6, 52, -80.6, 43, -46.6, 43, -44.6, 34, -19.6, 34, -17.6, 25, -11, 25, -11, 19.6, -20, 17.6, -20, 1.60001, -29, -0.399994, -29, -7, -61.8, -7, -65, -10.2, -65, -25.4, -74, -27.4, -74, -54, -71.1, -54, -65, -55.5, -65, -61.8, -61.8, -65, -56, -65, -56, -70.8, -52.8, -74, -28.6, -74, -26.6, -83, -11, -83, -11, -125.6, -2, -127.6, -2, -134.6, 7, -136.6, 7, -143.2, 8.60001, -144, 63, -144)

[sub_resource type="Animation" id="Animation_33oxi"]
resource_name = "mermaid_movement"
length = 20.0
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("MermaidPath/MermaidPathFollow:progress_ratio")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 20),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [1.0, 0.0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_1ppje"]
_data = {
"mermaid_movement": SubResource("Animation_33oxi")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_vw323"]
animation = &"mermaid_movement"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_sv0fw"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_2ckmi"]
states/Start/position = Vector2(429, 100)
states/mermaid_movement/node = SubResource("AnimationNodeAnimation_vw323")
states/mermaid_movement/position = Vector2(645, 100)
transitions = ["Start", "mermaid_movement", SubResource("AnimationNodeStateMachineTransition_sv0fw")]
graph_offset = Vector2(-59, -95)

[node name="Mermaid" type="Node2D"]
script = ExtResource("1_qhv04")

[node name="MermaidPath" type="Path2D" parent="."]
curve = SubResource("Curve2D_13ppp")

[node name="MermaidPathFollow" type="PathFollow2D" parent="MermaidPath"]
unique_name_in_owner = true
position = Vector2(-15.2096, -1.49363)
rotation = -2.35619
progress = 15.3107
rotates = false
script = ExtResource("2_ef8c6")

[node name="MermaidSprite" type="Sprite2D" parent="MermaidPath/MermaidPathFollow"]
unique_name_in_owner = true
z_index = 1
material = SubResource("ShaderMaterial_3mcd6")
position = Vector2(-2.15792e-05, -2.15792e-05)
rotation = 2.35619
scale = Vector2(0.75, 0.75)
texture = ExtResource("4_03ghs")

[node name="MermaidProgress" type="ProgressBar" parent="MermaidPath/MermaidPathFollow/MermaidSprite"]
unique_name_in_owner = true
anchors_preset = 10
anchor_right = 1.0
offset_left = -108.0
offset_top = -168.0
offset_right = -108.0
offset_bottom = -156.0
grow_horizontal = 2
theme = ExtResource("5_kglyx")
theme_type_variation = &"MermaidBar"
max_value = 10.0
show_percentage = false
script = ExtResource("6_w1srh")

[node name="LightOccluder2D" type="LightOccluder2D" parent="MermaidPath/MermaidPathFollow"]
position = Vector2(-2.15792e-05, -2.15792e-05)
rotation = 2.35619
scale = Vector2(0.75, 0.75)
occluder = SubResource("OccluderPolygon2D_q5ffp")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_1ppje")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeStateMachine_2ckmi")
anim_player = NodePath("../AnimationPlayer")
active = true

[node name="MermaidTimer" type="Timer" parent="."]
unique_name_in_owner = true
wait_time = 15.0
one_shot = true
autostart = true

[node name="BubbleSpawnTimer" type="Timer" parent="."]
unique_name_in_owner = true
autostart = true

[connection signal="timeout" from="MermaidTimer" to="." method="_on_mermaid_timer_timeout"]
[connection signal="timeout" from="BubbleSpawnTimer" to="." method="_on_bubble_spawn_timer_timeout"]
